# ver perfis e qual está ativo
adm paths profile list
adm paths profile current

# (re)criar/ajustar perfis prontos
adm paths profile apply --name=minimum   --set TARGET=x86_64-linux-musl --set SYSROOT=/usr/x86_64-linux-musl --set CFLAGS="-O2 -pipe" --set CXXFLAGS="-O2 -pipe"
adm paths profile apply --name=normal    --set CFLAGS="-O2 -fstack-protector-strong -pipe" --set CXXFLAGS="-O2 -fstack-protector-strong -pipe"
adm paths profile apply --name=aggressive --set CFLAGS="-O3 -march=native -mtune=native -pipe -fomit-frame-pointer" --set CXXFLAGS="-O3 -march=native -mtune=native -pipe -fomit-frame-pointer"

# escolher qual usar (vale para todos os builds do ADM)
adm paths profile select minimum

# Depois pode rodar
adm install binutils-stage0
adm install gcc-stage0
# etc.

# Caminho musl
adm install linux-headers-stage0      --profile=minimum --jobs=8
adm install binutils-stage0           --profile=minimum --jobs=8
adm install gcc-stage0                --profile=minimum --jobs=8
adm install musl-headers-stage0       --profile=minimum --jobs=8

# Caminho glibc
adm install linux-headers-stage0      --profile=minimum --jobs=8
adm install binutils-stage0           --profile=minimum --jobs=8
adm install gcc-stage0                --profile=minimum --jobs=8
adm install glibc-headers-stage0      --profile=minimum --jobs=8

# Ordem musl stage1
adm install musl-stage1        --profile=minimum --jobs=8
adm install gcc-stage1-musl    --profile=minimum --jobs=8

# Ordem glibc
adm install glibc-stage1        --profile=minimum --jobs=8
adm install gcc-stage1-glibc    --profile=minimum --jobs=8

# Musl
# stage0 já pronto: linux-headers-stage0, binutils-stage0, gcc-stage0, musl-headers-stage0
adm install musl-stage1        --profile=minimum --jobs=8
adm install gcc-stage1-musl    --profile=minimum --jobs=8

# Glibc
# stage0 já pronto: linux-headers-stage0, binutils-stage0, gcc-stage0, glibc-headers-stage0
adm install glibc-stage1       --profile=minimum --jobs=8
adm install gcc-stage1-glibc   --profile=minimum --jobs=8

# Musl ou Glibc
# Stage2
adm install binutils-stage2     --profile=minimum --jobs=8
adm install gcc-final           --profile=minimum --jobs=8

# Essenciais mínimos
adm install pkgconf             --profile=minimum --jobs=8
adm install make                --profile=minimum --jobs=8
adm install busybox             --profile=minimum --jobs=8
adm install xz zstd tar         --profile=minimum --jobs=8

# (Opcional) Migrar para GNU completos, substituindo aos poucos o BusyBox:
adm install coreutils sed grep gawk bash --profile=minimum --jobs=8


# Local dos profiles
/usr/src/adm/env/profiles/<nome>/

# Criação de profile
adm paths profile apply --name=minimum \
  --set TARGET=x86_64-linux-musl \
  --set SYSROOT=/usr/x86_64-linux-musl \
  --set CFLAGS="-O2 -pipe" \
  --set CXXFLAGS="-O2 -pipe" \
  --set LDFLAGS="" \
  --set MAKEFLAGS="-j$(nproc)" \
  --set PATH="/usr/bin:/bin:/usr/sbin:/sbin"

# Para instalar com profile
adm --profile=minimum install gcc-final

# Alternar profile
# Para build inicial (bootstrap)
adm paths profile select minimum

# Para builds normais
adm paths profile select normal

# Para builds agressivos
adm paths profile select aggressive

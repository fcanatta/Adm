#!/usr/bin/env bash
set -Eeuo pipefail
: "${WORKDIR:?}"
: "${DESTDIR:?}"

cd "$WORKDIR"
srcdir="$(find . -maxdepth 1 -type d -name 'ninja-*' | head -n1 || true)"
[[ -d "$srcdir" ]] || { echo "[ERR] diretório ninja-* não encontrado em $WORKDIR" >&2; exit 3; }

cd "$srcdir"

[[ -x "./ninja" ]] || { echo "[ERR] binário ./ninja não existe; build não foi feito?" >&2; exit 4; }

mkdir -p "${DESTDIR}/usr/bin"
install -m 0755 ./ninja "${DESTDIR}/usr/bin/ninja"

echo "[OK] ninja instalado em ${DESTDIR}/usr/bin/ninja"

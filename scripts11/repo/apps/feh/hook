#!/usr/bin/env bash
set -euo pipefail
IFS=$'\n\t'

feh_root() {
  [ -n "${ADM_INSTALL_ROOT:-}" ] && printf '%s' "$ADM_INSTALL_ROOT" ||
  [ -n "${DESTDIR:-}" ]          && printf '%s' "$DESTDIR"          ||
  printf '/'
}

adm_hook_pre_build() { :; }
adm_hook_build() { :; }

adm_hook_install() { :; }

adm_hook_post_install() {
  local root skel confdir
  root="$(feh_root)"
  skel="$root/etc/skel"
  confdir="$skel/.config/feh"

  mkdir -p "$confdir"
  if [ ! -f "$confdir/themes" ]; then
    cat >"$confdir/themes" <<'EOF'
# Tema padrÃ£o do feh gerado pelo ADM
feh_default -g 800x600 -B black --image-bg black --auto-zoom
EOF
  fi
}

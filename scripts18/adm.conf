#========================================================
#  /etc/adm.conf - Configuração do ADM / LFS
#
#  Perfis disponíveis:
#    - lfs  : construir um sistema LFS em /mnt/lfs
#    - host : gerenciar o sistema final instalando direto em /
#
#  Use:
#    ADM_PROFILE=lfs  sudo ./adm.sh status
#    ADM_PROFILE=host sudo ./adm.sh status
#
#  Se ADM_PROFILE não for definido, assume "lfs".
#========================================================

ADM_PROFILE="${ADM_PROFILE:-lfs}"

case "$ADM_PROFILE" in
    #---------------------------------------------
    # Perfil para construir o LFS em /mnt/lfs
    #---------------------------------------------
    lfs)
        # Raiz do sistema LFS em construção
        LFS="/mnt/lfs"

        # Usuário e grupo de build (como no livro LFS)
        LFS_USER="lfs"
        LFS_GROUP="lfs"

        # Diretórios principais dentro do LFS
        LFS_SOURCES_DIR="$LFS/sources"
        LFS_TOOLS_DIR="$LFS/tools"
        LFS_LOG_DIR="$LFS/logs"
        LFS_BUILD_SCRIPTS_DIR="$LFS/build-scripts"

        # Chroot "seguro" com unshare (namespaces)
        # 1 = tentar unshare / chroot seguro
        # 0 = chroot simples
        CHROOT_SECURE=1

        # Banco de dados do ADM dentro do LFS
        ADM_DB_DIR="$LFS/var/adm"
        ;;

    #---------------------------------------------
    # Perfil para gerenciar o SISTEMA FINAL (/)
    #---------------------------------------------
    host)
        # Raiz é o sistema real
        LFS="/"

        # Usuário/grupo para instalação no sistema final
        # (normalmente root)
        LFS_USER="root"
        LFS_GROUP="root"

        # Onde você guarda os tarballs / fontes no sistema final
        # Ajuste à vontade (exemplo: /usr/src/adm-sources)
        LFS_SOURCES_DIR="/usr/src/adm-sources"

        # Opcional: diretório para ferramentas auxiliares do ADM
        LFS_TOOLS_DIR="/usr/local/adm/tools"

        # Logs do ADM no sistema final
        LFS_LOG_DIR="/var/log/adm"

        # Onde vão ficar os scripts de build para o sistema final
        LFS_BUILD_SCRIPTS_DIR="/usr/local/adm/build-scripts"

        # No host, chroot "seguro" normalmente não é necessário
        # (você já está rodando no sistema real)
        CHROOT_SECURE=0

        # Banco de dados do ADM no host (manifests / meta)
        ADM_DB_DIR="/var/adm"
        ;;

    *)
        echo "ADM: ADM_PROFILE inválido: $ADM_PROFILE" >&2
        exit 1
        ;;
esac

# Systemd glibc
adm install sys/systemd sys/udev sys/dbus apps/openssh-server sys/networkmanager --with-deps

# Musl ou glib sem systemd
adm install sys/runit sys/eudev sys/elogind sys/dbus apps/openssh-server --with-deps

# Sysvinit + mdev
adm install sys/sysvinit sys/mdev sys/dbus apps/openssh-server --with-deps

# Musl toolchain 
binutils-pass1
gcc-pass1
linux-headers
musl
gcc-pass2
(opcional: llvm/clang)

# Glibc toolchain
binutils-pass1
gcc-pass1
linux-headers
glibc
binutils-pass2  (opcional)
gcc-pass2

# Checar que os metafiles são visíveis:
adm info sys/binutils
adm info sys/gcc
adm info sys/glibc
adm info sys/musl
adm info sys/linux-headers

# Rodar bootstrap (exemplo com glibc):
/usr/src/adm/scripts/90-bootstrap-toolchain run --libc=glibc --fetch --profile=minimal --jobs=$(nproc)

# Ou com musl:
#/usr/src/adm/scripts/90-bootstrap-toolchain run --libc=musl --fetch --profile=minimal --jobs=$(nproc)

# Exemplo: instalar curl com deps
adm install apps/curl --with-deps --pack --parallel=$(nproc)

# Ver versões
adm info apps/curl
adm info libs/openssl
adm info dev/pkgconf

# Exemplo de variáveis p/ um bootstrap glibc:
export TARGET=x86_64-linux-gnu
export PREFIX=/usr/src/adm/toolchain
export SYSROOT=/usr/src/adm/sysroot
export JOBS=$(nproc)

# 1) Binutils PASS1
adm install sys/binutils-pass1 --with-deps --pack

# 2) GCC PASS1 (usa gmp/mpfr/mpc/isl)
adm install sys/gcc-pass1 --with-deps --pack

# Variáveis
export TARGET=x86_64-linux-musl
export PREFIX=/usr/src/adm/toolchain
export SYSROOT=/usr/src/adm/sysroot
export JOBS=$(nproc)

# Pré-requisitos: você já instalou gmp/mpfr/mpc/isl (fez antes com gcc-pass1).
# Agora basta:
adm install sys/toolchain-musl --with-deps --pack --parallel="$JOBS"

# Passo a passo a construção 
adm install sys/binutils-pass1 --with-deps --pack
adm install sys/gcc-pass1      --with-deps --pack
adm install sys/linux-headers  --pack
adm install sys/musl           --pack
adm install sys/gcc-pass2      --with-deps --pack --parallel="$JOBS"

# Instalar gcc-final
adm install sys/gcc-final --with-deps --pack --parallel=$(nproc)

# Base de shell, ferramentas de usuários e rede
adm install sys/bash sys/procps-ng sys/kmod sys/kbd sys/iproute2 apps/dhcpcd --with-deps

# Usuários, FS, tempo
adm install sys/shadow sys/e2fsprogs sys/tzdata --with-deps

# Tooling restante de build
adm install dev/perl dev/texinfo dev/gettext sys/patch --with-deps

# Dependências p/ Firefox/LLVM que faltavam
adm install libs/libevent libs/icu libs/sqlite --with-deps

# (Opcional) toolchains binários para acelerar Firefox
adm install dev/nodejs dev/rust --with-deps

# rootfs + ext4.img 8 GiB + ISO
ADM_IMG_SIZE=8192 ADM_FS=ext4 ADM_ISO=1 adm-mkimage
# btrfs em 4 GiB
ADM_FS=btrfs adm-mkimage

# Assinar com gnupg
gpg --quick-gen-key "ADM Builder <root@localhost>"
gpg --output adm.iso.sig --detach-sign /usr/src/adm/out/adm-*.iso

# Seus hooks 020-generate-grubcfg.sh já fazem isso na instalação,
# mas você pode rodar manualmente depois de editar /etc/default/grub:
bash /usr/src/adm/metafiles/sys/grub-efi/hooks/post-install/020-generate-grubcfg.sh
# ou para BIOS:
bash /usr/src/adm/metafiles/sys/grub-pc/hooks/post-install/020-generate-grubcfg.sh
ADM_PROFILE=aggressive adm install sys/grub-efi --with-deps

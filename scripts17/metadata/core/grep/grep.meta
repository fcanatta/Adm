# Grep-3.12 - LFS r12.4 (8.36)
# https://www.linuxfromscratch.org/lfs/view/development/chapter08/grep.html (mesmas instruções da mirror)

PKG_NAME="grep"
PKG_VERSION="3.12"
PKG_RELEASE=1

PKG_SOURCE_URLS=(
  "https://ftp.gnu.org/gnu/grep/grep-3.12.tar.xz"
)

# MD5 do LFS
# grep-3.12.tar.xz -> 5d9301ed9d209c4a88c8d3a6fd08b9ac
PKG_MD5S=(
  "5d9301ed9d209c4a88c8d3a6fd08b9ac"
)

PKG_DEPENDS=()
PKG_GROUPS=("core" "utils")

PKG_UPSTREAM_URL="https://www.gnu.org/software/grep/"
PKG_UPSTREAM_REGEX='grep-([0-9.]+)\.tar\.xz'

PKG_BUILD() {
    # Remove warning chato de egrep/fgrep que quebra testes de outros pacotes
    sed -i "s/echo/#echo/" src/egrep.sh

    ./configure --prefix=/usr

    make

    if [[ "${ADM_RUN_TESTS:-1}" -eq 1 ]]; then
        make check
    fi
}

PKG_INSTALL() {
    make DESTDIR="$DESTDIR" install
}

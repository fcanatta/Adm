# Libxcrypt-4.5.1 - LFS r12.4-46 (8.28)
# https://www.linuxfromscratch.org/lfs/view/development/chapter08/libxcrypt.html

PKG_NAME="libxcrypt"
PKG_VERSION="4.5.1"
PKG_RELEASE=1

PKG_SOURCE_URLS=(
  "https://github.com/besser82/libxcrypt/releases/download/v4.5.1/libxcrypt-4.5.1.tar.xz"
)

# LFS r12.4-dev packages list
# MD5: 7be4cacda2055aa41133f7a577512a08
PKG_MD5S=(
  "7be4cacda2055aa41133f7a577512a08"
)

PKG_DEPENDS=()
PKG_GROUPS=("core" "libs")

PKG_UPSTREAM_URL="https://github.com/besser82/libxcrypt"
PKG_UPSTREAM_REGEX='libxcrypt-([0-9.]+)\.tar\.xz'

PKG_BUILD() {
    ./configure --prefix=/usr                \
                --enable-hashes=strong,glibc \
                --enable-obsolete-api=no     \
                --disable-static             \
                --disable-failure-tokens

    make

    if [[ "${ADM_RUN_TESTS:-1}" -eq 1 ]]; then
        make check
    fi
}

PKG_INSTALL() {
    make DESTDIR="$DESTDIR" install
}
